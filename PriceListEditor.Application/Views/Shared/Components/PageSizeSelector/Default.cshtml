@model BaseListViewModel

<form method="post" id=@("form"+@Model.PageViewModel.Pseudonym+"PageSizeSelector") onchange="SelectedItemChanged(this)" asp-controller="Product" asp-action="ProductList">
    <div class="d-grip gap-2">
        <b>Выберите размер страницы</b>
        <select id="pageSizeSelector">
            @foreach (int pageSize in Model.PageSizes)
            {
                @if (pageSize == Model.PageViewModel.PageSize)
                {
                    <option value="@pageSize" selected>@pageSize</option>
                }
                else
                {
                    <option value="@pageSize">@pageSize</option>
                }
            }
        </select>
    </div>
</form>

<script>
    function SelectedItemChanged(object) {
        var url = new URL(window.location.href);
        url.searchParams.set('pageSize', document.querySelector('#pageSizeSelector').value);
        url.searchParams.set('sortOrder', "@ViewBag.SortOrder");
        if (url.search != "") 
        {
            if (url.searchParams.get('category') != null) 
            {
                url.searchParams.set('category', "@ViewBag.SelectedCategory");
            }
            url.searchParams.set('productPage', "@Model.PageViewModel.CurrenPage");
        }
        else 
        {
            url.searchParams.set('productPage', 1);
        }
        window.location.href = url;
    }
</script>