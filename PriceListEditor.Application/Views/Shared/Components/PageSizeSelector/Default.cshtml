@model BaseListViewModel

<form method="post" id=@("form"+@Model.PageViewModel.Pseudonym+"PageSizeSelector") onchange="SelectedItemChanged(this)" asp-controller="Product" asp-action="ProductList">
    <div class="d-grip gap-2">
        <b>Выберите размер страницы</b>
        <select id="pageSizeSelector">
            @foreach (int pageSize in Model.PageSizes)
            {
                @if (pageSize == Model.PageViewModel.PageSize)
                {
                    <option value="@pageSize" selected>@pageSize</option>
                }
                else
                {
                    <option value="@pageSize">@pageSize</option>
                }
            }
        </select>
    </div>
</form>

<script>
    function SelectedItemChanged(object) {
        var oldUrl = new URL(window.location.href);
        var newUrl = new URL(oldUrl.protocol + "//" + oldUrl.host);
        if (oldUrl.pathname.includes("Size")) {
            var oldSize = oldUrl.pathname.slice(oldUrl.pathname.indexOf("Size") + 4, oldUrl.pathname.length);
            newUrl.pathname = oldUrl.pathname.replace("Size" + oldSize, "Size" + document.querySelector('#pageSizeSelector').value);
        }
        else {
            newUrl += '@Model.PageViewModel.Pseudonym' + "/Page1/Size" + document.querySelector('#pageSizeSelector').value;
        }
        window.location.href = newUrl;
    }
</script>